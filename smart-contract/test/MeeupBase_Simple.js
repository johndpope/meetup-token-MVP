// Deploy contract
var meetupbaseContract = web3.eth.contract([{"constant":true,"inputs":[],"name":"organiserAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"bytes32"}],"name":"registerUser","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"users","outputs":[{"name":"userCreateTime","type":"uint64"},{"name":"userAddress","type":"address"},{"name":"userName","type":"bytes32"},{"name":"hasDeregistered","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"meetups","outputs":[{"name":"createTime","type":"uint64"},{"name":"startTime","type":"uint64"},{"name":"maxCapacity","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"unpause","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"bytes32"}],"name":"deregisterUser","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getMeetupCount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_startTime","type":"uint64"},{"name":"_maxCapacity","type":"uint8"}],"name":"createMeetup","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"bytes32"}],"name":"userToAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newAssistant","type":"address"}],"name":"setAssistant_1","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"pause","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_newOrganiser","type":"address"}],"name":"setOrganiser","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_userName","type":"bytes32"}],"name":"createUser","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_id","type":"uint256"}],"name":"getUser","outputs":[{"name":"userCreateTime","type":"uint64"},{"name":"userAddress","type":"address"},{"name":"userName","type":"bytes32"},{"name":"hasDeregistered","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"assistantAddress_1","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newAssistant","type":"address"}],"name":"setAssistant_2","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"assistantAddress_2","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"addressToUser","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"startTime","type":"uint64"},{"indexed":false,"name":"maxCapacity","type":"uint8"}],"name":"MeeupEventCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"userCreateTime","type":"uint64"},{"indexed":false,"name":"userId","type":"uint256"},{"indexed":false,"name":"userName","type":"bytes32"}],"name":"UserCreated","type":"event"}]);
var meetupbase = meetupbaseContract.new(
   {
     from: web3.eth.accounts[0], 
     data: '0x60606040526000600260146101000a81548160ff021916908315150217905550341561002a57600080fd5b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506117b1806100fb6000396000f3006060604052600436106100fc576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806304e3c9b8146101015780632dc0325914610156578063365b98b21461017d57806337026ae1146102155780633f4ba83a14610288578063475469701461029d578063539f7fb7146102c45780635fc0aca2146102ed5780636c88beeb1461033a57806377bdfc57146103a15780638456cb59146103da5780638c4b0e7e146103ef578063abf7bfd814610428578063b0467deb14610463578063c8ded43e146104fb578063d923192714610550578063d92a174514610589578063edf53886146105de575b600080fd5b341561010c57600080fd5b610114610633565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561016157600080fd5b61017b600480803560001916906020019091905050610658565b005b341561018857600080fd5b61019e6004808035906020019091905050610769565b604051808567ffffffffffffffff1667ffffffffffffffff1681526020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200183600019166000191681526020018215151515815260200194505050505060405180910390f35b341561022057600080fd5b61023660048080359060200190919050506107e9565b604051808467ffffffffffffffff1667ffffffffffffffff1681526020018367ffffffffffffffff1667ffffffffffffffff1681526020018260ff1660ff168152602001935050505060405180910390f35b341561029357600080fd5b61029b610854565b005b34156102a857600080fd5b6102c26004808035600019169060200190919050506108e7565b005b34156102cf57600080fd5b6102d7610b06565b6040518082815260200191505060405180910390f35b34156102f857600080fd5b610324600480803567ffffffffffffffff1690602001909190803560ff16906020019091905050610b13565b6040518082815260200191505060405180910390f35b341561034557600080fd5b61035f600480803560001916906020019091905050610d92565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103ac57600080fd5b6103d8600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610dc5565b005b34156103e557600080fd5b6103ed610f50565b005b34156103fa57600080fd5b610426600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611094565b005b341561043357600080fd5b61044d60048080356000191690602001909190505061116e565b6040518082815260200191505060405180910390f35b341561046e57600080fd5b610484600480803590602001909190505061133f565b604051808567ffffffffffffffff1667ffffffffffffffff1681526020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200183600019166000191681526020018215151515815260200194505050505060405180910390f35b341561050657600080fd5b61050e6113cb565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561055b57600080fd5b610587600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506113f1565b005b341561059457600080fd5b61059c61157c565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156105e957600080fd5b610615600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506115a2565b60405180826000191660001916815260200191505060405180910390f35b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600060056000836000191660001916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161480156106be57506000816000191614155b156107665780600660003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081600019169055503360056000836000191660001916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50565b60048181548110151561077857fe5b90600052602060002090600302016000915090508060000160009054906101000a900467ffffffffffffffff16908060000160089054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010154908060020160009054906101000a900460ff16905084565b6003818154811015156107f857fe5b90600052602060002090016000915090508060000160009054906101000a900467ffffffffffffffff16908060000160089054906101000a900467ffffffffffffffff16908060000160109054906101000a900460ff16905083565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156108af57600080fd5b600260149054906101000a900460ff1615156108ca57600080fd5b6000600260146101000a81548160ff021916908315150217905550565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16148061098f5750600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b806109e75750600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b15156109f257600080fd5b600060056000836000191660001916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614158015610a5957506000816000191614155b15610b03576000600660003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208160001916905550600060056000836000191660001916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50565b6000600380549050905090565b6000610b1d6115ba565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161480610bc75750600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b80610c1f5750600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b1515610c2a57600080fd5b4267ffffffffffffffff168567ffffffffffffffff16111515610c4c57600080fd5b6060604051908101604052804267ffffffffffffffff1681526020018667ffffffffffffffff1681526020018560ff168152509150600160038054806001018281610c9791906115f3565b9160005260206000209001600085909190915060008201518160000160006101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060208201518160000160086101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060408201518160000160106101000a81548160ff021916908360ff16021790555050500390507fab0cb854bf4985f2a74779a5e848b4080deb126d0833eb6aa3239d5e1e663f568585604051808367ffffffffffffffff1667ffffffffffffffff1681526020018260ff1660ff1681526020019250505060405180910390a1809250505092915050565b60056020528060005260406000206000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161480610e6d5750600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b80610ec55750600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b1515610ed057600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614151515610f0c57600080fd5b80600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161480610ff85750600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b806110505750600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b151561105b57600080fd5b600260149054906101000a900460ff1615151561107757600080fd5b6001600260146101000a81548160ff021916908315150217905550565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156110ef57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415151561112b57600080fd5b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b600061117861161f565b6000803373ffffffffffffffffffffffffffffffffffffffff16141580156111a557506000846000191614155b15156111b057600080fd5b6080604051908101604052804267ffffffffffffffff1681526020013373ffffffffffffffffffffffffffffffffffffffff16815260200185600019168152602001600015158152509150600160048054806001018281611211919061166d565b9160005260206000209060030201600085909190915060008201518160000160006101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060208201518160000160086101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506040820151816001019060001916905560608201518160020160006101000a81548160ff02191690831515021790555050500390507f76132e572dfc008b139657cf5c9ddbed5df48e5d9eac3df431a8dc6653d6683f428286604051808467ffffffffffffffff1667ffffffffffffffff1681526020018381526020018260001916600019168152602001935050505060405180910390a18092505050919050565b600080600080600060048681548110151561135657fe5b906000526020600020906003020190508060000160009054906101000a900467ffffffffffffffff1694508060000160089054906101000a900473ffffffffffffffffffffffffffffffffffffffff169350806001015492508060020160009054906101000a900460ff169150509193509193565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614806114995750600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b806114f15750600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b15156114fc57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415151561153857600080fd5b80600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60066020528060005260406000206000915090505481565b606060405190810160405280600067ffffffffffffffff168152602001600067ffffffffffffffff168152602001600060ff1681525090565b81548183558181151161161a57818360005260206000209182019101611619919061169f565b5b505050565b608060405190810160405280600067ffffffffffffffff168152602001600073ffffffffffffffffffffffffffffffffffffffff168152602001600080191681526020016000151581525090565b81548183558181151161169a576003028160030283600052602060002091820191016116999190611708565b5b505050565b61170591905b8082111561170157600080820160006101000a81549067ffffffffffffffff02191690556000820160086101000a81549067ffffffffffffffff02191690556000820160106101000a81549060ff0219169055506001016116a5565b5090565b90565b61178291905b8082111561177e57600080820160006101000a81549067ffffffffffffffff02191690556000820160086101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905560018201600090556002820160006101000a81549060ff02191690555060030161170e565b5090565b905600a165627a7a7230582045b60942d50b640c8280bdf801c4f39a29899dc07e35ec8172f0526e3f36e0bf0029', 
     gas: '4700000'
   }, function (e, contract){
    console.log(e, contract);
    if (typeof contract.address !== 'undefined') {
         console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
    }
 })
// Prepare new accounts

personal.newAccount("1234")
personal.newAccount("1234")
personal.newAccount("1234")
personal.newAccount("1234")
personal.newAccount("1234")

personal.unlockAccount(eth.accounts[1], "1234", 99999)
personal.unlockAccount(eth.accounts[2], "1234", 99999)
personal.unlockAccount(eth.accounts[3], "1234", 99999)
personal.unlockAccount(eth.accounts[4], "1234", 99999)
personal.unlockAccount(eth.accounts[5], "1234", 99999)

eth.sendTransaction({from: eth.accounts[0], to: eth.accounts[1], value: web3.toWei(1234, "ether")})
eth.sendTransaction({from: eth.accounts[0], to: eth.accounts[2], value: web3.toWei(1234, "ether")})
eth.sendTransaction({from: eth.accounts[0], to: eth.accounts[3], value: web3.toWei(1234, "ether")})
eth.sendTransaction({from: eth.accounts[0], to: eth.accounts[4], value: web3.toWei(1234, "ether")})
eth.sendTransaction({from: eth.accounts[0], to: eth.accounts[5], value: web3.toWei(1234, "ether")})


// create users
meetupbase.createUser("A", {from: eth.accounts[0], gas:4000000, gasPrice:100})
meetupbase.createUser("B", {from: eth.accounts[1], gas:4000000, gasPrice:100})
meetupbase.createUser("C", {from: eth.accounts[2], gas:4000000, gasPrice:100})
meetupbase.createUser("D", {from: eth.accounts[3], gas:4000000, gasPrice:100})
meetupbase.createUser("E", {from: eth.accounts[4], gas:4000000, gasPrice:100})


// Define utility functions
// timestamp to string
function timestampToStr(timestamp) {  
  timestamp1 = new Date(timestamp*1000);
  dateStr = timestamp1.toLocaleString();
  return dateStr;
}

date = 1525696722;
timestampToStr(date);

// string to timestamp
function strToTimestamp(str) {  
  return new Date(str).getTime() / 1000;
}

dateTimeStr = "Mon, 07 May 2018 22:38:42 AEST";
strToTimestamp(dateTimeStr);



for (i = 0; i < 5; i++) { 
  console.log(i)
  console.log("Name: "+web3.toAscii(meetupbase.users(i)[2])+
            " Creation time: " + timestampToStr(meetupbase.users(i)[0])  +
            " Address: " + meetupbase.users(i)[1])
}

dateTimeStr = "Tue, 08 May 2018 22:38:42 AEST";
strToTimestamp(dateTimeStr);


// Not working yet
meetupbase.getMeetupCount()
meetupbase.createMeetup(strToTimestamp(dateTimeStr), 100, {from: eth.accounts[0], gas: 4000000, gasPrice:100})
meetupbase.getMeetupCount()

